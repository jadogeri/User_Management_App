{"file":"C:\\Users\\Joseph\\Desktop\\Source\\User_Management_App\\app\\server\\src\\database\\seeds\\role.seed.ts","mappings":";;AAGA,4DAAkD;AAClD,oDAAmF;AACnF,MAAqB,UAAU;IAC/B;;;;;;;SAOK;IACI,KAAK,CAAC,GAAG,CAAC,UAAsB;QACrC,MAAM,cAAc,GAAG,UAAU,CAAC,aAAa,CAAC,kBAAI,CAAC,CAAC;QACtD,MAAM,KAAK,GAAG,CAAC,qBAAS,EAAE,oBAAQ,EAAE,sBAAU,EAAE,sBAAU,CAAC,CAAC;QAE5D,KAAK,MAAM,IAAI,IAAI,KAAK,EAAE,CAAC;YACzB,4CAA4C;YAC5C,wEAAwE;YAExE,uBAAuB;YACvB,+CAA+C;YAC/C,IAAI;YACN,yDAAyD;YACzD,MAAM,cAAc,CAAC,MAAM,CACzB,IAAI,EACJ,CAAC,IAAI,CAAC,CACP,CAAC;YAEF,kDAAkD;YAClD,MAAM,SAAS,GAAG,MAAM,cAAc,CAAC,SAAS,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC;YAClE,IAAI,SAAS,EAAE,CAAC;gBACd,SAAS,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;gBACzC,MAAM,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,gDAAgD;YACxF,CAAC;QACD,CAAC;IACH,CAAC;CACF;AAlCD,6BAkCC","names":[],"sources":["C:\\Users\\Joseph\\Desktop\\Source\\User_Management_App\\app\\server\\src\\database\\seeds\\role.seed.ts"],"sourcesContent":["// src/database/seeds/RoleSeeder.ts\r\nimport { DataSource } from 'typeorm';\r\nimport { Seeder } from 'typeorm-extension';\r\nimport { Role } from '../../entities/role.entity';\r\nimport { AdminRole, UserRole, ViewerRole, EditorRole } from '../../data/role.data';\r\nexport default class RoleSeeder implements Seeder {\r\n/**\r\n   * Checks for the existence of predefined status entities in the database \r\n   * and saves them if they do not already exist. \r\n   * \r\n   * @param dataSource - The data source used to access the repository.\r\n   * @returns A promise that resolves to void.\r\n   * @throws Any errors thrown by the repository methods during execution.\r\n   */\r\n  public async run(dataSource: DataSource): Promise<void> {\r\n    const roleRepository = dataSource.getRepository(Role);\r\n    const roles = [AdminRole, UserRole, ViewerRole, EditorRole];\r\n\r\n    for (const role of roles) {\r\n      // // Check if the role already exists by ID\r\n      // const existingRole = await roleRepository.findOneBy({ id: role.id });\r\n      \r\n      // if (!existingRole) {\r\n      //   await roleRepository.upsert(role, [\"id\"]);\r\n      // }\r\n    // Use upsert for the Role itself to prevent ID conflicts\r\n    await roleRepository.upsert(\r\n      role,\r\n      [\"id\"]\r\n    );\r\n\r\n    // Re-fetch the role to establish relations safely\r\n    const savedRole = await roleRepository.findOneBy({ id: role.id });\r\n    if (savedRole) {\r\n      savedRole.permissions = role.permissions;\r\n      await roleRepository.save(savedRole); // TypeORM handles role_permission automatically\r\n    }\r\n    }\r\n  }\r\n}\r\n"],"version":3}