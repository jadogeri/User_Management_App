{"file":"C:\\Users\\Joseph\\Desktop\\Source\\User_Management_App\\app\\server\\src\\middlewares\\login-user.middleware.ts","mappings":";;;AAEA,oEAAmE;AAE5D,MAAM,mBAAmB,GAAG,CAAC,YAAoB,EAAE,MAAyB,EAAE,EAAE;IACrF,OAAO,KAAK,EAAE,GAAY,EAAE,GAAa,EAAE,IAAkB,EAAE,EAAE;QAC/D,IAAI,CAAC;YAEH,8BAA8B;YAC9B,MAAM,IAAI,GAAG,MAAM,IAAA,yCAAoB,EAAC,GAAG,EAAE,YAAY,EAAE,MAAM,CAAC,CAAC;YACnE,OAAO,CAAC,GAAG,CAAC,mBAAmB,EAAC,IAAI,CAAC,CAAC;YAEtC,0DAA0D;YACzD,GAAW,CAAC,IAAI,GAAG,IAAI,CAAC;YAEzB,IAAI,EAAE,CAAC;QACT,CAAC;QAAC,OAAO,KAAU,EAAE,CAAC;YACpB,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE,OAAO,EAAE,KAAK,CAAC,OAAO,IAAI,cAAc,EAAE,CAAC,CAAC;QACrE,CAAC;IACH,CAAC,CAAC;AACJ,CAAC,CAAC;AAhBW,QAAA,mBAAmB,uBAgB9B","names":[],"sources":["C:\\Users\\Joseph\\Desktop\\Source\\User_Management_App\\app\\server\\src\\middlewares\\login-user.middleware.ts"],"sourcesContent":["import { Request, Response, NextFunction } from 'express';\r\nimport { RBACPermission } from '../types/rbac.type';\r\nimport { expressAuthorization } from '../utils/authorization.util';\r\n\r\nexport const loginUserMiddleware = (securityName: string, scopes?: RBACPermission[]) => {\r\n  return async (req: Request, res: Response, next: NextFunction) => {\r\n    try {\r\n        \r\n      // Call your existing function\r\n      const user = await expressAuthorization(req, securityName, scopes);\r\n      console.log(\"user=============\",user);\r\n      \r\n      // Attach the result to the request for use in controllers\r\n      (req as any).user = user;\r\n      \r\n      next();\r\n    } catch (error: any) {\r\n      res.status(401).json({ message: error.message || 'Unauthorized' });\r\n    }\r\n  };\r\n};\r\n"],"version":3}