1d1a44d23142f2f2f41bf228083c7e26
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.payloadGenerator = void 0;
const resource_not_found_error_1 = require("../errors/resource-not-found.error");
/**
 * Generates a JWT payload from a User object.
 * @param user - The User object containing user details and permissions.
 * @returns JwtPayloadInterface - The constructed JWT payload.
 * @throws ResourceNotFoundError if the user is undefined or null.
 */
const payloadGenerator = (user) => {
    if (!user) {
        throw new resource_not_found_error_1.ResourceNotFoundError("User is undefined or null");
    }
    let payload = {
        user: {
            username: user.username, email: user.email, id: user.id, roles: user.roles
        },
        scopes: user.getPermissionNames(),
    };
    console.log("payload to be signed = ", payload);
    return payload;
};
exports.payloadGenerator = payloadGenerator;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxKb3NlcGhcXERlc2t0b3BcXFNvdXJjZVxcVXNlcl9NYW5hZ2VtZW50X0FwcFxcYXBwXFxzZXJ2ZXJcXHNyY1xcdXRpbHNcXHBheWxvYWQtZ2VuZXJhdG9yLnV0aWwudHMiLCJtYXBwaW5ncyI6Ijs7O0FBRUEsaUZBQTJFO0FBRTNFOzs7OztHQUtHO0FBQ0ksTUFBTSxnQkFBZ0IsR0FBRyxDQUFDLElBQVUsRUFBdUIsRUFBRTtJQUNoRSxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDUixNQUFNLElBQUksZ0RBQXFCLENBQUMsMkJBQTJCLENBQUMsQ0FBQztJQUNqRSxDQUFDO0lBQ0QsSUFBSSxPQUFPLEdBQXlCO1FBQ2hDLElBQUksRUFBRTtZQUNGLFFBQVEsRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLEtBQUssRUFBRSxJQUFJLENBQUMsS0FBSztTQUM3RTtRQUNELE1BQU0sRUFBRSxJQUFJLENBQUMsa0JBQWtCLEVBQUU7S0FDcEMsQ0FBQTtJQUNELE9BQU8sQ0FBQyxHQUFHLENBQUMseUJBQXlCLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDaEQsT0FBTyxPQUFPLENBQUM7QUFDbkIsQ0FBQyxDQUFBO0FBWlksUUFBQSxnQkFBZ0Isb0JBWTVCIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcSm9zZXBoXFxEZXNrdG9wXFxTb3VyY2VcXFVzZXJfTWFuYWdlbWVudF9BcHBcXGFwcFxcc2VydmVyXFxzcmNcXHV0aWxzXFxwYXlsb2FkLWdlbmVyYXRvci51dGlsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBVc2VyIGZyb20gXCIuLi9lbnRpdGllcy91c2VyLmVudGl0eVwiXHJcbmltcG9ydCB7IEp3dFBheWxvYWRJbnRlcmZhY2UgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9qd3QtcGF5bG9hZC5pbnRlcmZhY2VcIjtcclxuaW1wb3J0IHsgUmVzb3VyY2VOb3RGb3VuZEVycm9yIH0gZnJvbSBcIi4uL2Vycm9ycy9yZXNvdXJjZS1ub3QtZm91bmQuZXJyb3JcIjtcclxuXHJcbi8qKlxyXG4gKiBHZW5lcmF0ZXMgYSBKV1QgcGF5bG9hZCBmcm9tIGEgVXNlciBvYmplY3QuXHJcbiAqIEBwYXJhbSB1c2VyIC0gVGhlIFVzZXIgb2JqZWN0IGNvbnRhaW5pbmcgdXNlciBkZXRhaWxzIGFuZCBwZXJtaXNzaW9ucy5cclxuICogQHJldHVybnMgSnd0UGF5bG9hZEludGVyZmFjZSAtIFRoZSBjb25zdHJ1Y3RlZCBKV1QgcGF5bG9hZC5cclxuICogQHRocm93cyBSZXNvdXJjZU5vdEZvdW5kRXJyb3IgaWYgdGhlIHVzZXIgaXMgdW5kZWZpbmVkIG9yIG51bGwuXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgcGF5bG9hZEdlbmVyYXRvciA9ICh1c2VyOiBVc2VyKTogSnd0UGF5bG9hZEludGVyZmFjZSA9PiB7XHJcbiAgICBpZiAoIXVzZXIpIHtcclxuICAgICAgICB0aHJvdyBuZXcgUmVzb3VyY2VOb3RGb3VuZEVycm9yKFwiVXNlciBpcyB1bmRlZmluZWQgb3IgbnVsbFwiKTtcclxuICAgIH1cclxuICAgIGxldCBwYXlsb2FkIDogSnd0UGF5bG9hZEludGVyZmFjZSA9IHtcclxuICAgICAgICB1c2VyOiB7XHJcbiAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VyLnVzZXJuYW1lLCBlbWFpbDogdXNlci5lbWFpbCwgaWQ6IHVzZXIuaWQsIHJvbGVzOiB1c2VyLnJvbGVzXHJcbiAgICAgICAgfSxcclxuICAgICAgICBzY29wZXM6IHVzZXIuZ2V0UGVybWlzc2lvbk5hbWVzKCksXHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmxvZyhcInBheWxvYWQgdG8gYmUgc2lnbmVkID0gXCIsIHBheWxvYWQpO1xyXG4gICAgcmV0dXJuIHBheWxvYWQ7XHJcbn0iXSwidmVyc2lvbiI6M30=