{"file":"C:\\Users\\Joseph\\Desktop\\Source\\User_Management_App\\app\\server\\src\\services\\credential-validator.service.ts","mappings":";;;;;;;;AACA,8CAAwC;AAKxC,yEAA+D;AAC/D,mFAAyE;AACzE,0EAAoH;AAGpH,IAAM,0BAA0B,GAAhC,MAAM,0BAA0B;IAE5B,oBAAoB,CAAC,WAAiC;QAClD,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,GAAG,WAAW,CAAC;QAEzD,IAAI,CAAC,QAAQ,IAAI,CAAC,KAAK,IAAI,CAAC,QAAQ,EAAE,CAAC;YACnC,OAAO,IAAI,8CAAkB,CAAC,KAAK,EAAE,IAAI,oCAAa,CAAC,GAAG,EAAC,2BAA2B,CAAC,CAAC,CAAC;QAC7F,CAAC;QACD,IAAG,CAAC,IAAA,oCAAY,EAAC,KAAK,CAAC,EAAC,CAAC;YACrB,OAAO,IAAI,8CAAkB,CAAC,KAAK,EAAE,IAAI,oCAAa,CAAC,GAAG,EAAC,mBAAmB,CAAC,CAAC,CAAC;QACrF,CAAC;QACD,IAAG,CAAC,IAAA,uCAAe,EAAC,QAAQ,CAAC,EAAC,CAAC;YAC3B,OAAO,IAAI,8CAAkB,CAAC,KAAK,EAAE,IAAI,oCAAa,CAAC,GAAG,EAAC,sBAAsB,CAAC,CAAC,CAAC;QAExF,CAAC;QACD,IAAG,CAAC,IAAA,uCAAe,EAAC,QAAQ,CAAC,EAAC,CAAC;YAC3B,OAAO,IAAI,8CAAkB,CAAC,KAAK,EAAE,IAAI,oCAAa,CAAC,GAAG,EAAC,sBAAsB,CAAC,CAAC,CAAC;QACxF,CAAC;QACD,qEAAqE;QACrE,IAAG,KAAK,EAAC,CAAC;YAEN,IAAG,CAAC,IAAA,6CAAqB,EAAC,KAAK,CAAE,EAAC,CAAC;gBAC/B,OAAO,IAAI,8CAAkB,CAAC,KAAK,EAAE,IAAI,oCAAa,CAAC,GAAG,EAAC,0BAA0B,CAAC,CAAC,CAAC;YAC5F,CAAC;QACL,CAAC;QAED,OAAO,IAAI,8CAAkB,CAAC,IAAI,CAAC,CAAC;IAExC,CAAC;IAED,aAAa,CAAC,WAAgC;QAC1C,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAG,GAAG,WAAW,CAAC;QACzC,IAAI,CAAC,KAAK,IAAI,CAAC,QAAQ,EAAE,CAAC;YACtB,OAAO,IAAI,8CAAkB,CAAC,KAAK,EAAE,IAAI,oCAAa,CAAC,GAAG,EAAC,2BAA2B,CAAC,CAAC,CAAC;QAC7F,CAAC;QAED,IAAG,CAAC,IAAA,oCAAY,EAAC,KAAK,CAAC,EAAC,CAAC;YACrB,OAAO,IAAI,8CAAkB,CAAC,KAAK,EAAE,IAAI,oCAAa,CAAC,GAAG,EAAC,oCAAoC,CAAC,CAAC,CAAC;QACtG,CAAC;QAED,OAAO,IAAI,8CAAkB,CAAC,IAAI,CAAC,CAAC;IAExC,CAAC;IAED,sBAAsB,CAAC,WAAyC;QAC5D,MAAM,EAAE,KAAK,EAAE,GAAG,WAAW,CAAC;QAE9B,IAAG,CAAC,KAAK,EAAC,CAAC;YACP,OAAO,IAAI,8CAAkB,CAAC,KAAK,EAAE,IAAI,oCAAa,CAAC,GAAG,EAAC,qBAAqB,CAAC,CAAC,CAAC;QACvF,CAAC;QACD,IAAG,CAAC,IAAA,oCAAY,EAAC,KAAK,CAAC,EAAC,CAAC;YACrB,OAAO,IAAI,8CAAkB,CAAC,KAAK,EAAE,IAAI,oCAAa,CAAC,GAAG,EAAC,oBAAoB,CAAC,CAAC,CAAC;QACtF,CAAC;QACD,OAAO,IAAI,8CAAkB,CAAC,IAAI,CAAC,CAAC;IAGxC,CAAC;IAED,cAAc,CAAC,WAAgC;QAC3C,MAAM,KAAK,GAAG,WAAW,CAAC,KAAK,CAAC;QAChC,IAAG,CAAC,KAAK,EAAC,CAAC;YACP,OAAO,IAAI,8CAAkB,CAAC,KAAK,EAAE,IAAI,oCAAa,CAAC,GAAG,EAAC,0BAA0B,CAAC,CAAC,CAAC;QAC5F,CAAC;QACD,OAAO,IAAI,8CAAkB,CAAC,IAAI,CAAC,CAAC;IACxC,CAAC;IAED,qBAAqB,CAAC,WAAwC;QAC1D,MAAM,EAAE,KAAK,EAAE,WAAW,EAAE,WAAW,EAAE,kBAAkB,EAAE,GAAG,WAAW,CAAC;QAC5E,IAAI,CAAC,KAAK,IAAI,CAAC,WAAW,IAAI,CAAC,WAAW,IAAI,CAAC,kBAAkB,EAAE,CAAC;YAClE,OAAO,IAAI,8CAAkB,CAAC,KAAK,EAAE,IAAI,oCAAa,CAAC,GAAG,EAAE,2BAA2B,CAAC,CAAC,CAAC;QAE5F,CAAC;QACD,IAAG,CAAC,IAAA,oCAAY,EAAC,KAAK,CAAC,EAAC,CAAC;YACvB,OAAO,IAAI,8CAAkB,CAAC,KAAK,EAAE,IAAI,oCAAa,CAAC,GAAG,EAAC,oBAAoB,CAAC,CAAC,CAAC;QAEpF,CAAC;QACD,IAAG,CAAC,IAAA,uCAAe,EAAC,WAAW,CAAC,EAAC,CAAC;YAChC,OAAO,IAAI,8CAAkB,CAAC,KAAK,EAAE,IAAI,oCAAa,CAAC,GAAG,EAAC,0BAA0B,CAAC,CAAC,CAAC;QAC1F,CAAC;QACD,IAAG,WAAW,KAAK,kBAAkB,EAAC,CAAC;YACrC,OAAO,IAAI,8CAAkB,CAAC,KAAK,EAAE,IAAI,oCAAa,CAAC,GAAG,EAAC,wBAAwB,CAAC,CAAC,CAAC;QACxF,CAAC;QACD,OAAO,IAAI,8CAAkB,CAAC,IAAI,CAAC,CAAC;IAExC,CAAC;IACD,kBAAkB,CAAC,WAAqC;QACpD,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,mBAAmB,EAAC,GAA+B,WAAW,CAAA;QACvF,IAAI,CAAC,KAAK,IAAI,CAAC,QAAQ,IAAI,mBAAmB,IAAI,SAAS,EAAE,CAAC;YAC1D,OAAO,IAAI,8CAAkB,CAAC,KAAK,EAAE,IAAI,oCAAa,CAAC,GAAG,EAAC,2BAA2B,CAAC,CAAC,CAAC;QAC7F,CAAC;QACD,IAAG,CAAC,IAAA,oCAAY,EAAC,KAAK,CAAE,EAAC,CAAC;YACtB,OAAO,IAAI,8CAAkB,CAAC,KAAK,EAAE,IAAI,oCAAa,CAAC,GAAG,EAAC,oBAAoB,CAAC,CAAC,CAAC;QAEtF,CAAC;QACD,IAAG,mBAAmB,KAAK,IAAI,EAAC,CAAC;YAC7B,OAAO,IAAI,8CAAkB,CAAC,KAAK,EAAE,IAAI,oCAAa,CAAC,GAAG,EAAC,sBAAsB,CAAC,CAAC,CAAC;QAExF,CAAC;QACD,OAAO,IAAI,8CAAkB,CAAC,IAAI,CAAC,CAAC;IAExC,CAAC;CAGJ,CAAA;AAvGK,0BAA0B;IAD/B,IAAA,oBAAO,GAAE;GACJ,0BAA0B,CAuG/B;AAED,kBAAe,0BAA0B,CAAC","names":[],"sources":["C:\\Users\\Joseph\\Desktop\\Source\\User_Management_App\\app\\server\\src\\services\\credential-validator.service.ts"],"sourcesContent":["\r\nimport { Service } from \"../decorators\";\r\nimport { AuthLoginRequestDTO, AuthForgotPasswordRequestDTO, AuthResetPasswordRequestDTO } from \"../dtos/requests/auth-request.dto\";\r\nimport { UserCreateRequestDTO, UserDeactivateRequestDTO } from \"../dtos/requests/user-request.dto\";\r\nimport { CredentialValidatorServiceInterface } from \"../interfaces/credential-validator-service.interface\";\r\nimport { JwtPayloadInterface } from \"../interfaces/jwt-payload.interface\";\r\nimport { ErrorResponse } from \"../models/error-response.model\";\r\nimport { ValidationResponse } from \"../models/validation-response.model\";\r\nimport {isValidEmail, isValidPassword, isValidUsername, isValidatePhoneNumber} from \"../utils/input-validation.util\"\r\n\r\n@Service()\r\nclass CredentialValidatorService implements CredentialValidatorServiceInterface{\r\n\r\n    validateRegistration(userRequest: UserCreateRequestDTO): ValidationResponse{\r\n        const { username, email, password, phone } = userRequest;\r\n\r\n        if (!username || !email || !password) {\r\n            return new ValidationResponse(false, new ErrorResponse(400,\"All fields are mandatory!\"));\r\n        }\r\n        if(!isValidEmail(email)){\r\n            return new ValidationResponse(false, new ErrorResponse(400,\"not a valid email\"));\r\n        }\r\n        if(!isValidUsername(username)){\r\n            return new ValidationResponse(false, new ErrorResponse(400,\"not a valid username\"));\r\n\r\n        }\r\n        if(!isValidPassword(password)){\r\n            return new ValidationResponse(false, new ErrorResponse(400,\"not a valid password\"));\r\n        }  \r\n        //if phone number is provided check if string is a valid phone number\r\n        if(phone){\r\n\r\n            if(!isValidatePhoneNumber(phone )){\r\n                return new ValidationResponse(false, new ErrorResponse(400,\"not a valid phone number\"));\r\n            }  \r\n        }    \r\n\r\n        return new ValidationResponse(true);\r\n\r\n    }\r\n\r\n    validateLogin(userRequest: AuthLoginRequestDTO): ValidationResponse{\r\n        const { email, password  } = userRequest;\r\n        if (!email || !password) {\r\n            return new ValidationResponse(false, new ErrorResponse(400,\"All fields are mandatory!\"));\r\n        }\r\n\r\n        if(!isValidEmail(email)){\r\n            return new ValidationResponse(false, new ErrorResponse(400,\"not a valid standard email address\"));\r\n        }\r\n\r\n        return new ValidationResponse(true);\r\n\r\n    }\r\n\r\n    validateForgotPassword(userRequest: AuthForgotPasswordRequestDTO): ValidationResponse{\r\n        const { email } = userRequest;\r\n\r\n        if(!email){\r\n            return new ValidationResponse(false, new ErrorResponse(400,\"Email is mandatory!\"));\r\n        }\r\n        if(!isValidEmail(email)){\r\n            return new ValidationResponse(false, new ErrorResponse(400,\"not a  valid email\"));\r\n        }\r\n        return new ValidationResponse(true);\r\n\r\n\r\n    }\r\n\r\n    validateLogout(userRequest: JwtPayloadInterface): ValidationResponse{\r\n        const token = userRequest.token;\r\n        if(!token){ \r\n            return new ValidationResponse(false, new ErrorResponse(400,\"field token is mandatory\"));\r\n        } \r\n        return new ValidationResponse(true);\r\n    }\r\n\r\n    validateResetPassword(userRequest: AuthResetPasswordRequestDTO): ValidationResponse{\r\n        const { email, oldPassword, newPassword, confirmNewPassword } = userRequest;\r\n        if (!email || !oldPassword || !newPassword || !confirmNewPassword) {\r\n          return new ValidationResponse(false, new ErrorResponse(400 ,\"All fields are mandatory!\"));\r\n    \r\n        }\r\n        if(!isValidEmail(email)){\r\n          return new ValidationResponse(false, new ErrorResponse(400,\"not a  valid email\"));\r\n      \r\n        }\r\n        if(!isValidPassword(newPassword)){\r\n          return new ValidationResponse(false, new ErrorResponse(400,\"not a valid new password\"));\r\n        }  \r\n        if(newPassword !== confirmNewPassword){\r\n          return new ValidationResponse(false, new ErrorResponse(400,\"passwords do not match\"));\r\n        }\r\n        return new ValidationResponse(true);    \r\n\r\n    }\r\n    validateDeactivate(userRequest: UserDeactivateRequestDTO): ValidationResponse{\r\n        const { email, password, confirmDeactivation} : UserDeactivateRequestDTO  = userRequest\r\n        if (!email || !password || confirmDeactivation == undefined) {\r\n            return new ValidationResponse(false, new ErrorResponse(400,\"All fields are mandatory!\"));\r\n        }\r\n        if(!isValidEmail(email )){\r\n            return new ValidationResponse(false, new ErrorResponse(400,\"not a  valid email\"));\r\n\r\n        }\r\n        if(confirmDeactivation !== true){\r\n            return new ValidationResponse(false, new ErrorResponse(400,\"confirm must be true\"));\r\n\r\n        }\r\n        return new ValidationResponse(true);    \r\n\r\n    }\r\n\r\n    \r\n}\r\n\r\nexport default CredentialValidatorService;"],"version":3}