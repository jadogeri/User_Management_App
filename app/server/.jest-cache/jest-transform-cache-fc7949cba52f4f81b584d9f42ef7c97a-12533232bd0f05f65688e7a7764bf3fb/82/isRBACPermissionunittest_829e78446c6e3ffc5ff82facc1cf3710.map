{"file":"C:\\Users\\Joseph\\Desktop\\Source\\User_Management_App\\app\\server\\tests\\unit\\utils\\isRBACPermission.unit.test.ts","mappings":";;AAAA,4DAAgE;AAChE,oFAA4E;AAE5E,QAAQ,CAAC,4CAA4C,EAAE,GAAG,EAAE;IAC1D,cAAc;IACd,QAAQ,CAAC,aAAa,EAAE,GAAG,EAAE;QAC3B,EAAE,CAAC,0DAA0D,EAAE,GAAG,EAAE;YAClE,yCAAyC;YACzC,MAAM,CAAC,IAAA,wCAAgB,EAAC,GAAG,oBAAQ,CAAC,IAAI,IAAI,kBAAM,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC3E,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,6DAA6D,EAAE,GAAG,EAAE;YACrE,4BAA4B;YAC5B,MAAM,CAAC,IAAA,wCAAgB,EAAC,GAAG,oBAAQ,CAAC,OAAO,IAAI,kBAAM,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC3E,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,2DAA2D,EAAE,GAAG,EAAE;YACnE,8BAA8B;YAC9B,MAAM,CAAC,IAAA,wCAAgB,EAAC,GAAG,oBAAQ,CAAC,GAAG,IAAI,kBAAM,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACxE,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,8DAA8D,EAAE,GAAG,EAAE;YACtE,2BAA2B;YAC3B,MAAM,CAAC,IAAA,wCAAgB,EAAC,GAAG,oBAAQ,CAAC,GAAG,IAAI,kBAAM,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACvE,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,+DAA+D,EAAE,GAAG,EAAE;YACvE,iDAAiD;YACjD,MAAM,CAAC,MAAM,CAAC,oBAAQ,CAAC,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,EAAE;gBAC3C,MAAM,CAAC,MAAM,CAAC,kBAAM,CAAC,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE,EAAE;oBACvC,MAAM,CAAC,IAAA,wCAAgB,EAAC,GAAG,QAAQ,IAAI,MAAM,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAC/D,CAAC,CAAC,CAAC;YACL,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,aAAa;IACb,QAAQ,CAAC,YAAY,EAAE,GAAG,EAAE;QAC1B,EAAE,CAAC,iEAAiE,EAAE,GAAG,EAAE;YACzE,uCAAuC;YACvC,MAAM,CAAC,IAAA,wCAAgB,EAAC,mBAAmB,kBAAM,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC3E,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,iEAAiE,EAAE,GAAG,EAAE;YACzE,sCAAsC;YACtC,MAAM,CAAC,IAAA,wCAAgB,EAAC,GAAG,oBAAQ,CAAC,IAAI,gBAAgB,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACzE,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,0DAA0D,EAAE,GAAG,EAAE;YAClE,+BAA+B;YAC/B,MAAM,CAAC,IAAA,wCAAgB,EAAC,+BAA+B,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACxE,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,iDAAiD,EAAE,GAAG,EAAE;YACzD,qBAAqB;YACrB,MAAM,CAAC,IAAA,wCAAgB,EAAC,GAAG,oBAAQ,CAAC,IAAI,GAAG,kBAAM,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC3E,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,sCAAsC,EAAE,GAAG,EAAE;YAC9C,wBAAwB;YACxB,MAAM,CAAC,IAAA,wCAAgB,EAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC3C,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,gDAAgD,EAAE,GAAG,EAAE;YACxD,uBAAuB;YACvB,MAAM,CAAC,IAAA,wCAAgB,EAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC5C,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,sDAAsD,EAAE,GAAG,EAAE;YAC9D,6BAA6B;YAC7B,MAAM,CAAC,IAAA,wCAAgB,EAAC,IAAI,kBAAM,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC5D,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,oDAAoD,EAAE,GAAG,EAAE;YAC5D,2BAA2B;YAC3B,MAAM,CAAC,IAAA,wCAAgB,EAAC,GAAG,oBAAQ,CAAC,IAAI,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC5D,CAAC,CAAC,CAAC;QAGH,EAAE,CAAC,0EAA0E,EAAE,GAAG,EAAE;YAClF,8CAA8C;YAC9C,MAAM,CAAC,IAAA,wCAAgB,EAAC,IAAI,oBAAQ,CAAC,IAAI,MAAM,kBAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAChF,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,6DAA6D,EAAE,GAAG,EAAE;YACrE,2BAA2B;YAC3B,MAAM,CAAC,IAAA,wCAAgB,EAAC,GAAG,oBAAQ,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,kBAAM,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACxF,MAAM,CAAC,IAAA,wCAAgB,EAAC,GAAG,oBAAQ,CAAC,IAAI,IAAI,kBAAM,CAAC,MAAM,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC1F,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,qDAAqD,EAAE,GAAG,EAAE;YAC7D,oBAAoB;YACpB,MAAM,CAAC,IAAA,wCAAgB,EAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAClD,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,mEAAmE,EAAE,GAAG,EAAE;YAC3E,+BAA+B;YAC/B,MAAM,CAAC,IAAA,wCAAgB,EAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAClD,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","names":[],"sources":["C:\\Users\\Joseph\\Desktop\\Source\\User_Management_App\\app\\server\\tests\\unit\\utils\\isRBACPermission.unit.test.ts"],"sourcesContent":["import { Action, Resource } from \"../../../src/types/rbac.type\";\r\nimport { isRBACPermission } from '../../../src/utils/isRBACPermission.util';\r\n\r\ndescribe('isRBACPermission() isRBACPermission method', () => {\r\n  // Happy paths\r\n  describe('Happy paths', () => {\r\n    it('should return true for a valid resource and valid action', () => {\r\n      // Test a typical valid permission string\r\n      expect(isRBACPermission(`${Resource.USER}:${Action.CREATE}`)).toBe(true);\r\n    });\r\n\r\n    it('should return true for a valid resource and wildcard action', () => {\r\n      // Test with wildcard action\r\n      expect(isRBACPermission(`${Resource.PRODUCT}:${Action.ALL}`)).toBe(true);\r\n    });\r\n\r\n    it('should return true for wildcard resource and valid action', () => {\r\n      // Test with wildcard resource\r\n      expect(isRBACPermission(`${Resource.ALL}:${Action.READ}`)).toBe(true);\r\n    });\r\n\r\n    it('should return true for wildcard resource and wildcard action', () => {\r\n      // Test with both wildcards\r\n      expect(isRBACPermission(`${Resource.ALL}:${Action.ALL}`)).toBe(true);\r\n    });\r\n\r\n    it('should return true for all valid resource-action combinations', () => {\r\n      // Test all combinations of resources and actions\r\n      Object.values(Resource).forEach((resource) => {\r\n        Object.values(Action).forEach((action) => {\r\n          expect(isRBACPermission(`${resource}:${action}`)).toBe(true);\r\n        });\r\n      });\r\n    });\r\n  });\r\n\r\n  // Edge cases\r\n  describe('Edge cases', () => {\r\n    it('should return false for an invalid resource with a valid action', () => {\r\n      // Test with a resource not in the enum\r\n      expect(isRBACPermission(`invalidResource:${Action.CREATE}`)).toBe(false);\r\n    });\r\n\r\n    it('should return false for a valid resource with an invalid action', () => {\r\n      // Test with an action not in the enum\r\n      expect(isRBACPermission(`${Resource.USER}:invalidAction`)).toBe(false);\r\n    });\r\n\r\n    it('should return false for both invalid resource and action', () => {\r\n      // Test with both parts invalid\r\n      expect(isRBACPermission(`invalidResource:invalidAction`)).toBe(false);\r\n    });\r\n\r\n    it('should return false for missing colon separator', () => {\r\n      // Test with no colon\r\n      expect(isRBACPermission(`${Resource.USER}${Action.CREATE}`)).toBe(false);\r\n    });\r\n\r\n    it('should return false for empty string', () => {\r\n      // Test with empty input\r\n      expect(isRBACPermission('')).toBe(false);\r\n    });\r\n\r\n    it('should return false for string with only colon', () => {\r\n      // Test with only colon\r\n      expect(isRBACPermission(':')).toBe(false);\r\n    });\r\n\r\n    it('should return false for string with missing resource', () => {\r\n      // Test with missing resource\r\n      expect(isRBACPermission(`:${Action.CREATE}`)).toBe(false);\r\n    });\r\n\r\n    it('should return false for string with missing action', () => {\r\n      // Test with missing action\r\n      expect(isRBACPermission(`${Resource.USER}:`)).toBe(false);\r\n    });\r\n\r\n \r\n    it('should return false for resource and action with leading/trailing spaces', () => {\r\n      // Test with spaces around resource and action\r\n      expect(isRBACPermission(` ${Resource.USER} : ${Action.CREATE} `)).toBe(false);\r\n    });\r\n\r\n    it('should return false for resource and action with wrong case', () => {\r\n      // Test with incorrect case\r\n      expect(isRBACPermission(`${Resource.USER.toUpperCase()}:${Action.CREATE}`)).toBe(false);\r\n      expect(isRBACPermission(`${Resource.USER}:${Action.CREATE.toUpperCase()}`)).toBe(false);\r\n    });\r\n\r\n    it('should return false for numeric resource and action', () => {\r\n      // Test with numbers\r\n      expect(isRBACPermission(`123:456`)).toBe(false);\r\n    });\r\n\r\n    it('should return false for special characters in resource and action', () => {\r\n      // Test with special characters\r\n      expect(isRBACPermission(`!@#:$%^`)).toBe(false);\r\n    });\r\n  });\r\n});"],"version":3}