2dcf720e0467919105c712ac179f24e6
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isRBACPermission = isRBACPermission;
const rbac_type_1 = require("../types/rbac.type");
/**
 * Checks if the given string is a valid RBAC permission in the format "resource:action".
 * Validates both the resource and action against predefined enums.
 *
 * @param val - The permission string to validate.
 * @returns True if the permission is valid, otherwise false.
 *
 * @throws None
 */
function isRBACPermission(val) {
    const [res, act] = val.split(':');
    const isValidResource = Object.values(rbac_type_1.Resource).includes(res);
    const isValidAction = Object.values(rbac_type_1.Action).includes(act);
    return isValidResource && isValidAction;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxKb3NlcGhcXERlc2t0b3BcXFNvdXJjZVxcVXNlcl9NYW5hZ2VtZW50X0FwcFxcYXBwXFxzZXJ2ZXJcXHNyY1xcdXRpbHNcXGlzUkJBQ1Blcm1pc3Npb24udXRpbC50cyIsIm1hcHBpbmdzIjoiOztBQVdBLDRDQU1DO0FBakJELGtEQUFzRTtBQUV0RTs7Ozs7Ozs7R0FRRztBQUNILFNBQWdCLGdCQUFnQixDQUFDLEdBQVc7SUFDMUMsTUFBTSxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUMsR0FBRyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBRWxDLE1BQU0sZUFBZSxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUMsb0JBQVEsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxHQUFlLENBQUMsQ0FBQztJQUMxRSxNQUFNLGFBQWEsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLGtCQUFNLENBQUMsQ0FBQyxRQUFRLENBQUMsR0FBYSxDQUFDLENBQUM7SUFDcEUsT0FBTyxlQUFlLElBQUksYUFBYSxDQUFDO0FBQzFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxKb3NlcGhcXERlc2t0b3BcXFNvdXJjZVxcVXNlcl9NYW5hZ2VtZW50X0FwcFxcYXBwXFxzZXJ2ZXJcXHNyY1xcdXRpbHNcXGlzUkJBQ1Blcm1pc3Npb24udXRpbC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBY3Rpb24sIFJCQUNQZXJtaXNzaW9uLCBSZXNvdXJjZSB9IGZyb20gXCIuLi90eXBlcy9yYmFjLnR5cGVcIjtcclxuXHJcbi8qKlxyXG4gKiBDaGVja3MgaWYgdGhlIGdpdmVuIHN0cmluZyBpcyBhIHZhbGlkIFJCQUMgcGVybWlzc2lvbiBpbiB0aGUgZm9ybWF0IFwicmVzb3VyY2U6YWN0aW9uXCIuXHJcbiAqIFZhbGlkYXRlcyBib3RoIHRoZSByZXNvdXJjZSBhbmQgYWN0aW9uIGFnYWluc3QgcHJlZGVmaW5lZCBlbnVtcy5cclxuICogXHJcbiAqIEBwYXJhbSB2YWwgLSBUaGUgcGVybWlzc2lvbiBzdHJpbmcgdG8gdmFsaWRhdGUuXHJcbiAqIEByZXR1cm5zIFRydWUgaWYgdGhlIHBlcm1pc3Npb24gaXMgdmFsaWQsIG90aGVyd2lzZSBmYWxzZS5cclxuICogXHJcbiAqIEB0aHJvd3MgTm9uZVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGlzUkJBQ1Blcm1pc3Npb24odmFsOiBzdHJpbmcpOiB2YWwgaXMgUkJBQ1Blcm1pc3Npb24ge1xyXG4gIGNvbnN0IFtyZXMsIGFjdF0gPSB2YWwuc3BsaXQoJzonKTtcclxuICBcclxuICBjb25zdCBpc1ZhbGlkUmVzb3VyY2UgPSBPYmplY3QudmFsdWVzKFJlc291cmNlKS5pbmNsdWRlcyhyZXMgYXMgUmVzb3VyY2UpO1xyXG4gIGNvbnN0IGlzVmFsaWRBY3Rpb24gPSBPYmplY3QudmFsdWVzKEFjdGlvbikuaW5jbHVkZXMoYWN0IGFzIEFjdGlvbik7ICAgIFxyXG4gIHJldHVybiBpc1ZhbGlkUmVzb3VyY2UgJiYgaXNWYWxpZEFjdGlvbjtcclxufSJdLCJ2ZXJzaW9uIjozfQ==