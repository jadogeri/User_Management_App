{"file":"C:\\Users\\Joseph\\Desktop\\Source\\User_Management_App\\app\\server\\src\\services\\token-generator.service.ts","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,8CAAwC;AAGxC,kDAAoC;AAKpC,IACM,qBAAqB,GAD3B,MACM,qBAAqB;IAEvB;QAmCA,uBAAkB,GAAG,CAAC,KAAa,EAAkC,EAAE;YACnE,IAAI,CAAC;gBACD,OAAO,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,OAAO,CAAC,GAAG,EAAE,oBAAkC,CAAC,CAAC;YAC9E,CAAC;YAAC,OAAO,GAAY,EAAE,CAAC;gBACpB,IAAI,GAAG,YAAY,GAAG,CAAC,iBAAiB,EAAE,CAAC;oBACvC,OAAO,CAAC,GAAG,CAAC,qCAAqC,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC;oBAChE,OAAO,SAAS,CAAC;gBACrB,CAAC;YACL,CAAC;QACL,CAAC,CAAC;IA5Ca,CAAC;IAEhB,mBAAmB,CAAC,OAA4B;QAE5C,IAAI,SAAS,GAAI,OAAO,CAAC,GAAG,EAAE,mBAAiC,CAAC;QAEhE,OAAO,CAAC,GAAG,CAAC,yCAAyC,EAAE,SAAS,CAAC,CAAC;QAElE,MAAM,uBAAuB,GAAG,OAAO,CAAC,GAAG,CAAC,uBAAsC,IAAK,KAAK,CAAC;QAE7F,MAAM,OAAO,GAAgB,EAAE,SAAS,EAAE,uBAAuB,EAAE,CAAC;QAEpE,MAAM,WAAW,GAAW,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE,SAAS,EAAE,OAAO,CAAC,CAAC;QAElE,OAAO,CAAC,GAAG,CAAC,0BAA0B,EAAE,WAAW,CAAC,CAAC;QAErD,OAAO,WAAW,CAAC;IACvB,CAAC;IACD,oBAAoB,CAAC,OAA4B;QAG7C,IAAI,SAAS,GAAI,OAAO,CAAC,GAAG,EAAE,oBAAkC,CAAC;QAEjE,OAAO,CAAC,GAAG,CAAC,0CAA0C,EAAE,SAAS,CAAC,CAAC;QAEnE,MAAM,wBAAwB,GAAG,OAAO,CAAC,GAAG,CAAC,wBAAuC,IAAK,IAAI,CAAC;QAC9F,MAAM,OAAO,GAAgB,EAAE,SAAS,EAAE,wBAAwB,EAAE,CAAC;QAErE,MAAM,YAAY,GAAW,GAAG,CAAC,IAAI,CAAC,OAAO,EAAE,SAAS,EAAE,OAAO,CAAC,CAAC;QAEnE,OAAO,CAAC,GAAG,CAAC,2BAA2B,EAAE,YAAY,CAAC,CAAC;QAEvD,OAAO,YAAY,CAAC;IACxB,CAAC;CAYJ,CAAA;AA/CK,qBAAqB;IAD1B,IAAA,oBAAO,GAAE;;GACJ,qBAAqB,CA+C1B;AAED,kBAAe,qBAAqB,CAAC","names":[],"sources":["C:\\Users\\Joseph\\Desktop\\Source\\User_Management_App\\app\\server\\src\\services\\token-generator.service.ts"],"sourcesContent":["import { Service } from \"../decorators\";\r\nimport { JwtPayloadInterface } from \"../interfaces/jwt-payload.interface\";\r\nimport { TokenGeneratorInterface } from \"../interfaces/token-generator.interface\";\r\nimport * as jwt from 'jsonwebtoken';\r\nimport { JwtPayload, SignOptions } from \"jsonwebtoken\";\r\nimport { StringValue } from 'ms'; \r\n\r\n\r\n@Service()\r\nclass TokenGeneratorService implements TokenGeneratorInterface {\r\n\r\n    constructor(){ }\r\n\r\n    generateAccessToken(payload: JwtPayloadInterface): string{  \r\n        \r\n        let secretKey  = process.env?.ACCESS_TOKEN_SECRET as jwt.Secret;\r\n\r\n        console.log(\"Generating access token with secretKey:\", secretKey);\r\n\r\n        const ACCESS_TOKEN_EXPIRES_IN = process.env.ACCESS_TOKEN_EXPIRES_IN as StringValue  || '10m';\r\n\r\n        const options: SignOptions = { expiresIn: ACCESS_TOKEN_EXPIRES_IN };\r\n\r\n        const accessToken: string = jwt.sign(payload, secretKey, options);\r\n        \r\n        console.log(\"Generated Access Token: \", accessToken);\r\n\r\n        return accessToken;\r\n    }\r\n    generateRefreshToken(payload: JwtPayloadInterface): string{ \r\n        \r\n\r\n        let secretKey  = process.env?.REFRESH_TOKEN_SECRET as jwt.Secret;\r\n\r\n        console.log(\"Generating refresh token with secretKey:\", secretKey);\r\n\r\n        const REFRESH_TOKEN_EXPIRES_IN = process.env.REFRESH_TOKEN_EXPIRES_IN as StringValue  || '7d'; \r\n        const options: SignOptions = { expiresIn: REFRESH_TOKEN_EXPIRES_IN };\r\n\r\n        const refreshToken: string = jwt.sign(payload, secretKey, options);\r\n        \r\n        console.log(\"Generated Refresh Token: \", refreshToken);\r\n\r\n        return refreshToken;\r\n    }\r\n\r\n    verifyRefreshToken = (token: string): string| JwtPayload | undefined => {\r\n        try {\r\n            return jwt.verify(token, process.env?.REFRESH_TOKEN_SECRET as jwt.Secret);\r\n        } catch (err: unknown) {\r\n            if (err instanceof jwt.JsonWebTokenError) { \r\n                console.log(\"Refresh token verification failed: \", err.message);\r\n                return undefined;\r\n            }\r\n        }\r\n    };\r\n}\r\n\r\nexport default TokenGeneratorService;\r\n\r\n"],"version":3}