91dcb8f2c82ed4b325be80c054cb7a72
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.iocContainer = exports.bindDataSource = void 0;
// src/ioc.config.ts
const inversify_1 = require("inversify");
const tsoa_1 = require("tsoa");
const inversify_binding_decorators_1 = require("inversify-binding-decorators");
const binding_type_1 = require("../types/binding.type");
const auth_service_1 = require("../services/auth.service");
const auth_repository_1 = require("../repositories/auth.repository");
const auth_controller_1 = require("../controllers/auth.controller");
const user_service_1 = require("../services/user.service");
const user_repository_1 = require("../repositories/user.repository");
const user_controller_1 = require("../controllers/user.controller");
const sqlite_service_1 = require("../services/sqlite.service");
const password_generator_service_1 = __importDefault(require("../services/password-generator.service"));
const credential_validator_service_1 = __importDefault(require("../services/credential-validator.service"));
const email_service_1 = __importDefault(require("../services/email.service"));
const token_generator_service_1 = __importDefault(require("../services/token-generator.service"));
const cookie_storage_service_1 = __importDefault(require("../services/cookie-storage.service"));
const token_validator_service_1 = __importDefault(require("../services/token-validator.service"));
const access_control_service_1 = __importDefault(require("../services/access-control.service"));
const profile_repository_1 = require("../repositories/profile.repository");
const profile_service_1 = require("../services/profile.service");
const profile_controller_1 = require("../controllers/profile.controller");
const contact_controller_1 = require("../controllers/contact.controller");
const contact_service_1 = require("../services/contact.service");
const contact_repository_1 = require("../repositories/contact.repository");
// // import { UserController } from '../controllers/user.controller';
// import TokenGeneratorService from '../services/token-generator.service';
// import { TokenGeneratorInterface } from '../interfaces/token-generator.interface';
const iocContainer = new inversify_1.Container();
exports.iocContainer = iocContainer;
(0, inversify_1.decorate)((0, inversify_1.injectable)(), tsoa_1.Controller);
iocContainer.load((0, inversify_binding_decorators_1.buildProviderModule)());
//  0. bind controllers
iocContainer.bind(user_controller_1.UserController).toSelf();
iocContainer.bind(auth_controller_1.AuthController).toSelf();
iocContainer.bind(profile_controller_1.ProfileController).toSelf();
iocContainer.bind(contact_controller_1.ContactController).toSelf();
// 1. Bind the service that manages the connection
iocContainer.bind(sqlite_service_1.SQLiteService).toSelf().inSingletonScope();
iocContainer.bind(binding_type_1.TYPES.DatabaseServiceInterface).to(sqlite_service_1.SQLiteService).inSingletonScope();
iocContainer.bind(binding_type_1.TYPES.AuthServiceInterface).to(auth_service_1.AuthService).inSingletonScope();
iocContainer.bind(binding_type_1.TYPES.UserServiceInterface).to(user_service_1.UserService).inSingletonScope();
iocContainer.bind(binding_type_1.TYPES.ContactServiceInterface).to(contact_service_1.ContactService).inSingletonScope();
iocContainer.bind(binding_type_1.TYPES.ProfileServiceInterface).to(profile_service_1.ProfileService).inSingletonScope();
iocContainer.bind(binding_type_1.TYPES.PasswordGeneratorInterface).to(password_generator_service_1.default).inSingletonScope();
// 2. Bind the Repository (it will wait for TYPES.DataSource to be available)
iocContainer.bind(binding_type_1.TYPES.UserRepositoryInterface).to(user_repository_1.UserRepository).inSingletonScope();
iocContainer.bind(binding_type_1.TYPES.AuthRepositoryInterface).to(auth_repository_1.AuthRepository).inSingletonScope();
iocContainer.bind(binding_type_1.TYPES.ProfileRepositoryInterface).to(profile_repository_1.ProfileRepository).inSingletonScope();
iocContainer.bind(binding_type_1.TYPES.ContactRepositoryInterface).to(contact_repository_1.ContactRepository).inSingletonScope();
iocContainer.bind(binding_type_1.TYPES.CredentialValidatorServiceInterface).to(credential_validator_service_1.default).inSingletonScope();
iocContainer.bind(binding_type_1.TYPES.EmailServiceInterface).to(email_service_1.default).inSingletonScope();
iocContainer.bind(binding_type_1.TYPES.TokenGeneratorInterface).to(token_generator_service_1.default).inSingletonScope();
iocContainer.bind(binding_type_1.TYPES.TokenValidatorInterface).to(token_validator_service_1.default).inSingletonScope();
iocContainer.bind(binding_type_1.TYPES.CookieStorageInterface).to(cookie_storage_service_1.default).inSingletonScope();
iocContainer.bind(binding_type_1.TYPES.AccessControlInterface).to(access_control_service_1.default).inSingletonScope();
// 3. Helper to bind the live DataSource after connection
/**
 * Binds a given DataSource instance to the IoC container as a constant value.
 * This allows for dependency injection of the DataSource throughout the application.
 *
 * @param {DataSource} dataSource - The DataSource instance to be bound.
 * @returns {void}
 * @throws {Error} Throws an error if the binding fails.
 */
const bindDataSource = (dataSource) => {
    iocContainer.bind(binding_type_1.TYPES.DataSource).toConstantValue(dataSource);
};
exports.bindDataSource = bindDataSource;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxKb3NlcGhcXERlc2t0b3BcXFNvdXJjZVxcVXNlcl9NYW5hZ2VtZW50X0FwcFxcYXBwXFxzZXJ2ZXJcXHNyY1xcY29uZmlnc1xcaW9jLmNvbmZpZy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxvQkFBb0I7QUFDcEIseUNBQTREO0FBRTVELCtCQUFrQztBQUNsQywrRUFBbUU7QUFDbkUsd0RBQThDO0FBRTlDLDJEQUF1RDtBQUV2RCxxRUFBaUU7QUFDakUsb0VBQWdFO0FBRWhFLDJEQUF1RDtBQUV2RCxxRUFBaUU7QUFDakUsb0VBQWdFO0FBR2hFLCtEQUEyRDtBQUMzRCx3R0FBOEU7QUFHOUUsNEdBQWtGO0FBRWxGLDhFQUFxRDtBQUVyRCxrR0FBd0U7QUFFeEUsZ0dBQXNFO0FBRXRFLGtHQUF3RTtBQUV4RSxnR0FBc0U7QUFFdEUsMkVBQXVFO0FBQ3ZFLGlFQUE2RDtBQUU3RCwwRUFBc0U7QUFDdEUsMEVBQXNFO0FBRXRFLGlFQUE2RDtBQUc3RCwyRUFBdUU7QUFDdkUsc0VBQXNFO0FBR3RFLDJFQUEyRTtBQUMzRSxxRkFBcUY7QUFJckYsTUFBTSxZQUFZLEdBQUcsSUFBSSxxQkFBUyxFQUFFLENBQUM7QUFrRDVCLG9DQUFZO0FBaERyQixJQUFBLG9CQUFRLEVBQUMsSUFBQSxzQkFBVSxHQUFFLEVBQUUsaUJBQVUsQ0FBQyxDQUFDO0FBQ25DLFlBQVksQ0FBQyxJQUFJLENBQUMsSUFBQSxrREFBbUIsR0FBRSxDQUFDLENBQUM7QUFFdkMsdUJBQXVCO0FBQ3JCLFlBQVksQ0FBQyxJQUFJLENBQWlCLGdDQUFjLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQztBQUMzRCxZQUFZLENBQUMsSUFBSSxDQUFpQixnQ0FBYyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUM7QUFDM0QsWUFBWSxDQUFDLElBQUksQ0FBb0Isc0NBQWlCLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQztBQUNqRSxZQUFZLENBQUMsSUFBSSxDQUE2QixzQ0FBaUIsQ0FBQyxDQUFDLE1BQU0sRUFBRSxD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QUFDLGVBQWUsQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUM5RSxDQUFDLENBQUM7QUFGVyxRQUFBLGNBQWMsa0JBRXpCIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcSm9zZXBoXFxEZXNrdG9wXFxTb3VyY2VcXFVzZXJfTWFuYWdlbWVudF9BcHBcXGFwcFxcc2VydmVyXFxzcmNcXGNvbmZpZ3NcXGlvYy5jb25maWcudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gc3JjL2lvYy5jb25maWcudHNcclxuaW1wb3J0IHsgQ29udGFpbmVyLCBkZWNvcmF0ZSwgaW5qZWN0YWJsZSB9IGZyb20gJ2ludmVyc2lmeSc7XHJcbmltcG9ydCB7IERhdGFTb3VyY2UgfSBmcm9tICd0eXBlb3JtJztcclxuaW1wb3J0IHsgQ29udHJvbGxlciB9IGZyb20gJ3Rzb2EnO1xyXG5pbXBvcnQgeyBidWlsZFByb3ZpZGVyTW9kdWxlIH0gZnJvbSBcImludmVyc2lmeS1iaW5kaW5nLWRlY29yYXRvcnNcIjtcclxuaW1wb3J0IHsgVFlQRVMgfSBmcm9tICcuLi90eXBlcy9iaW5kaW5nLnR5cGUnO1xyXG5pbXBvcnQgeyBBdXRoU2VydmljZUludGVyZmFjZX0gZnJvbSAnLi4vaW50ZXJmYWNlcy9hdXRoLXNlcnZpY2UuaW50ZXJmYWNlJztcclxuaW1wb3J0IHsgQXV0aFNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9hdXRoLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBBdXRoUmVwb3NpdG9yeUludGVyZmFjZSB9IGZyb20gJy4uL2ludGVyZmFjZXMvYXV0aC1yZXBvc2l0b3J5LmludGVyZmFjZSc7XHJcbmltcG9ydCB7IEF1dGhSZXBvc2l0b3J5IH0gZnJvbSAnLi4vcmVwb3NpdG9yaWVzL2F1dGgucmVwb3NpdG9yeSc7XHJcbmltcG9ydCB7IEF1dGhDb250cm9sbGVyIH0gZnJvbSAnLi4vY29udHJvbGxlcnMvYXV0aC5jb250cm9sbGVyJztcclxuaW1wb3J0IHsgVXNlclNlcnZpY2VJbnRlcmZhY2V9IGZyb20gJy4uL2ludGVyZmFjZXMvdXNlci1zZXJ2aWNlLmludGVyZmFjZSc7XHJcbmltcG9ydCB7IFVzZXJTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvdXNlci5zZXJ2aWNlJztcclxuaW1wb3J0IHsgVXNlclJlcG9zaXRvcnlJbnRlcmZhY2UgfSBmcm9tICcuLi9pbnRlcmZhY2VzL3VzZXItcmVwb3NpdG9yeS5pbnRlcmZhY2UnO1xyXG5pbXBvcnQgeyBVc2VyUmVwb3NpdG9yeSB9IGZyb20gJy4uL3JlcG9zaXRvcmllcy91c2VyLnJlcG9zaXRvcnknO1xyXG5pbXBvcnQgeyBVc2VyQ29udHJvbGxlciB9IGZyb20gJy4uL2NvbnRyb2xsZXJzL3VzZXIuY29udHJvbGxlcic7XHJcblxyXG5pbXBvcnQgeyBEYXRhYmFzZVNlcnZpY2VJbnRlcmZhY2UgfSBmcm9tICcuLi9pbnRlcmZhY2VzL2RhdGFiYXNlLXNlcnZpY2UuaW50ZXJmYWNlJztcclxuaW1wb3J0IHsgU1FMaXRlU2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL3NxbGl0ZS5zZXJ2aWNlJztcclxuaW1wb3J0IFBhc3N3b3JkR2VuZXJhdG9yU2VydmljZSBmcm9tICcuLi9zZXJ2aWNlcy9wYXNzd29yZC1nZW5lcmF0b3Iuc2VydmljZSc7XHJcbmltcG9ydCB7IFBhc3N3b3JkR2VuZXJhdG9ySW50ZXJmYWNlIH0gZnJvbSAnLi4vaW50ZXJmYWNlcy9wYXNzd29yZC1nZW5lcmF0b3IuaW50ZXJmYWNlJztcclxuIGltcG9ydCB7IENyZWRlbnRpYWxWYWxpZGF0b3JTZXJ2aWNlSW50ZXJmYWNlIH0gZnJvbSAnLi4vaW50ZXJmYWNlcy9jcmVkZW50aWFsLXZhbGlkYXRvci1zZXJ2aWNlLmludGVyZmFjZSc7XHJcbmltcG9ydCBDcmVkZW50aWFsVmFsaWRhdG9yU2VydmljZSBmcm9tICcuLi9zZXJ2aWNlcy9jcmVkZW50aWFsLXZhbGlkYXRvci5zZXJ2aWNlJztcclxuaW1wb3J0IHsgRW1haWxTZXJ2aWNlSW50ZXJmYWNlIH0gZnJvbSAnLi4vaW50ZXJmYWNlcy9lbWFpbC1zZXJ2aWNlLmludGVyZmFjZSc7XHJcbmltcG9ydCBFbWFpbFNlcnZpY2UgZnJvbSAnLi4vc2VydmljZXMvZW1haWwuc2VydmljZSc7XHJcbmltcG9ydCB7IFRva2VuR2VuZXJhdG9ySW50ZXJmYWNlIH0gZnJvbSAnLi4vaW50ZXJmYWNlcy90b2tlbi1nZW5lcmF0b3IuaW50ZXJmYWNlJztcclxuaW1wb3J0IFRva2VuR2VuZXJhdG9yU2VydmljZSBmcm9tICcuLi9zZXJ2aWNlcy90b2tlbi1nZW5lcmF0b3Iuc2VydmljZSc7XHJcbmltcG9ydCB7IENvb2tpZVN0b3JhZ2VJbnRlcmZhY2UgfSBmcm9tICcuLi9pbnRlcmZhY2VzL2Nvb2tpZS1zdG9yYWdlLmludGVyZmFjZSc7XHJcbmltcG9ydCBDb29raWVTdG9yYWdlU2VydmljZSBmcm9tICcuLi9zZXJ2aWNlcy9jb29raWUtc3RvcmFnZS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgVG9rZW5WYWxpZGF0b3JJbnRlcmZhY2UgfSBmcm9tICcuLi9pbnRlcmZhY2VzL3Rva2VuLXZhbGlkYXRvci5pbnRlcmZhY2UnO1xyXG5pbXBvcnQgVG9rZW5WYWxpZGF0b3JTZXJ2aWNlIGZyb20gJy4uL3NlcnZpY2VzL3Rva2VuLXZhbGlkYXRvci5zZXJ2aWNlJztcclxuaW1wb3J0IHsgQWNjZXNzQ29udHJvbEludGVyZmFjZSB9IGZyb20gJy4uL2ludGVyZmFjZXMvYWNjZXNzLWNvbnRyb2wuaW50ZXJmYWNlJztcclxuaW1wb3J0IEFjY2Vzc0NvbnRyb2xTZXJ2aWNlIGZyb20gJy4uL3NlcnZpY2VzL2FjY2Vzcy1jb250cm9sLnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBQcm9maWxlUmVwb3NpdG9yeUludGVyZmFjZSB9IGZyb20gJy4uL2ludGVyZmFjZXMvcHJvZmlsZS1yZXBvc2l0b3J5LmludGVyZmFjZSc7XHJcbmltcG9ydCB7IFByb2ZpbGVSZXBvc2l0b3J5IH0gZnJvbSAnLi4vcmVwb3NpdG9yaWVzL3Byb2ZpbGUucmVwb3NpdG9yeSc7XHJcbmltcG9ydCB7IFByb2ZpbGVTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvcHJvZmlsZS5zZXJ2aWNlJztcclxuaW1wb3J0IHsgUHJvZmlsZVNlcnZpY2VJbnRlcmZhY2UgfSBmcm9tICcuLi9pbnRlcmZhY2VzL3Byb2ZpbGUtc2VydmljZS5pbnRlcmZhY2UnO1xyXG5pbXBvcnQgeyBQcm9maWxlQ29udHJvbGxlciB9IGZyb20gJy4uL2NvbnRyb2xsZXJzL3Byb2ZpbGUuY29udHJvbGxlcic7XHJcbmltcG9ydCB7IENvbnRhY3RDb250cm9sbGVyIH0gZnJvbSAnLi4vY29udHJvbGxlcnMvY29udGFjdC5jb250cm9sbGVyJztcclxuaW1wb3J0IHsgQ29udGFjdENvbnRyb2xsZXJJbnRlcmZhY2UgfSBmcm9tICcuLi9pbnRlcmZhY2VzL2NvbnRhY3QtY29udHJvbGxlci5pbnRlcmZhY2UnO1xyXG5pbXBvcnQgeyBDb250YWN0U2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2NvbnRhY3Quc2VydmljZSc7XHJcbmltcG9ydCB7IENvbnRhY3RTZXJ2aWNlSW50ZXJmYWNlIH0gZnJvbSAnLi4vaW50ZXJmYWNlcy9jb250YWN0LXNlcnZpY2UuaW50ZXJmYWNlJztcclxuaW1wb3J0IHsgQ29udGFjdFJlcG9zaXRvcnlJbnRlcmZhY2UgfSBmcm9tICcuLi9pbnRlcmZhY2VzL2NvbnRhY3QtcmVwb3NpdG9yeS5pbnRlcmZhY2UnO1xyXG5pbXBvcnQgeyBDb250YWN0UmVwb3NpdG9yeSB9IGZyb20gJy4uL3JlcG9zaXRvcmllcy9jb250YWN0LnJlcG9zaXRvcnknO1xyXG4vLyAvLyBpbXBvcnQgeyBVc2VyQ29udHJvbGxlciB9IGZyb20gJy4uL2NvbnRyb2xsZXJzL3VzZXIuY29udHJvbGxlcic7XHJcblxyXG5cclxuLy8gaW1wb3J0IFRva2VuR2VuZXJhdG9yU2VydmljZSBmcm9tICcuLi9zZXJ2aWNlcy90b2tlbi1nZW5lcmF0b3Iuc2VydmljZSc7XHJcbi8vIGltcG9ydCB7IFRva2VuR2VuZXJhdG9ySW50ZXJmYWNlIH0gZnJvbSAnLi4vaW50ZXJmYWNlcy90b2tlbi1nZW5lcmF0b3IuaW50ZXJmYWNlJztcclxuXHJcblxyXG5cclxuY29uc3QgaW9jQ29udGFpbmVyID0gbmV3IENvbnRhaW5lcigpO1xyXG5cclxuZGVjb3JhdGUoaW5qZWN0YWJsZSgpLCBDb250cm9sbGVyKTsgXHJcbmlvY0NvbnRhaW5lci5sb2FkKGJ1aWxkUHJvdmlkZXJNb2R1bGUoKSk7XHJcblxyXG4gIC8vICAwLiBiaW5kIGNvbnRyb2xsZXJzXHJcbiAgICBpb2NDb250YWluZXIuYmluZDxVc2VyQ29udHJvbGxlcj4oVXNlckNvbnRyb2xsZXIpLnRvU2VsZigpO1xyXG4gICAgaW9jQ29udGFpbmVyLmJpbmQ8QXV0aENvbnRyb2xsZXI+KEF1dGhDb250cm9sbGVyKS50b1NlbGYoKTtcclxuICAgIGlvY0NvbnRhaW5lci5iaW5kPFByb2ZpbGVDb250cm9sbGVyPihQcm9maWxlQ29udHJvbGxlcikudG9TZWxmKCk7XHJcbiAgICBpb2NDb250YWluZXIuYmluZDxDb250YWN0Q29udHJvbGxlckludGVyZmFjZT4oQ29udGFjdENvbnRyb2xsZXIpLnRvU2VsZigpO1xyXG5cclxuXHJcbiAgICAvLyAxLiBCaW5kIHRoZSBzZXJ2aWNlIHRoYXQgbWFuYWdlcyB0aGUgY29ubmVjdGlvblxyXG4gICAgaW9jQ29udGFpbmVyLmJpbmQ8U1FMaXRlU2VydmljZT4oU1FMaXRlU2VydmljZSkudG9TZWxmKCkuaW5TaW5nbGV0b25TY29wZSgpO1xyXG4gICAgaW9jQ29udGFpbmVyLmJpbmQ8RGF0YWJhc2VTZXJ2aWNlSW50ZXJmYWNlPihUWVBFUy5EYXRhYmFzZVNlcnZpY2VJbnRlcmZhY2UpLnRvKFNRTGl0ZVNlcnZpY2UpLmluU2luZ2xldG9uU2NvcGUoKTtcclxuICAgIGlvY0NvbnRhaW5lci5iaW5kPEF1dGhTZXJ2aWNlSW50ZXJmYWNlPihUWVBFUy5BdXRoU2VydmljZUludGVyZmFjZSkudG8oQXV0aFNlcnZpY2UpLmluU2luZ2xldG9uU2NvcGUoKTtcclxuICAgIGlvY0NvbnRhaW5lci5iaW5kPFVzZXJTZXJ2aWNlSW50ZXJmYWNlPihUWVBFUy5Vc2VyU2VydmljZUludGVyZmFjZSkudG8oVXNlclNlcnZpY2UpLmluU2luZ2xldG9uU2NvcGUoKTtcclxuICAgIGlvY0NvbnRhaW5lci5iaW5kPENvbnRhY3RTZXJ2aWNlSW50ZXJmYWNlPihUWVBFUy5Db250YWN0U2VydmljZUludGVyZmFjZSkudG8oQ29udGFjdFNlcnZpY2UpLmluU2luZ2xldG9uU2NvcGUoKTtcclxuICAgIGlvY0NvbnRhaW5lci5iaW5kPFByb2ZpbGVTZXJ2aWNlSW50ZXJmYWNlPihUWVBFUy5Qcm9maWxlU2VydmljZUludGVyZmFjZSkudG8oUHJvZmlsZVNlcnZpY2UpLmluU2luZ2xldG9uU2NvcGUoKTtcclxuICAgIGlvY0NvbnRhaW5lci5iaW5kPFBhc3N3b3JkR2VuZXJhdG9ySW50ZXJmYWNlPihUWVBFUy5QYXNzd29yZEdlbmVyYXRvckludGVyZmFjZSkudG8oUGFzc3dvcmRHZW5lcmF0b3JTZXJ2aWNlKS5pblNpbmdsZXRvblNjb3BlKCk7XHJcblxyXG5cclxuICAgIC8vIDIuIEJpbmQgdGhlIFJlcG9zaXRvcnkgKGl0IHdpbGwgd2FpdCBmb3IgVFlQRVMuRGF0YVNvdXJjZSB0byBiZSBhdmFpbGFibGUpXHJcbiAgICBpb2NDb250YWluZXIuYmluZDxVc2VyUmVwb3NpdG9yeUludGVyZmFjZT4oVFlQRVMuVXNlclJlcG9zaXRvcnlJbnRlcmZhY2UpLnRvKFVzZXJSZXBvc2l0b3J5KS5pblNpbmdsZXRvblNjb3BlKCk7XHJcbiAgICBpb2NDb250YWluZXIuYmluZDxBdXRoUmVwb3NpdG9yeUludGVyZmFjZT4oVFlQRVMuQXV0aFJlcG9zaXRvcnlJbnRlcmZhY2UpLnRvKEF1dGhSZXBvc2l0b3J5KS5pblNpbmdsZXRvblNjb3BlKCk7XHJcbiAgICBpb2NDb250YWluZXIuYmluZDxQcm9maWxlUmVwb3NpdG9yeUludGVyZmFjZT4oVFlQRVMuUHJvZmlsZVJlcG9zaXRvcnlJbnRlcmZhY2UpLnRvKFByb2ZpbGVSZXBvc2l0b3J5KS5pblNpbmdsZXRvblNjb3BlKCk7XHJcbiAgICBpb2NDb250YWluZXIuYmluZDxDb250YWN0UmVwb3NpdG9yeUludGVyZmFjZT4oVFlQRVMuQ29udGFjdFJlcG9zaXRvcnlJbnRlcmZhY2UpLnRvKENvbnRhY3RSZXBvc2l0b3J5KS5pblNpbmdsZXRvblNjb3BlKCk7XHJcblxyXG5cclxuICAgIGlvY0NvbnRhaW5lci5iaW5kPENyZWRlbnRpYWxWYWxpZGF0b3JTZXJ2aWNlSW50ZXJmYWNlPihUWVBFUy5DcmVkZW50aWFsVmFsaWRhdG9yU2VydmljZUludGVyZmFjZSkudG8oQ3JlZGVudGlhbFZhbGlkYXRvclNlcnZpY2UpLmluU2luZ2xldG9uU2NvcGUoKTtcclxuICAgIGlvY0NvbnRhaW5lci5iaW5kPEVtYWlsU2VydmljZUludGVyZmFjZT4oVFlQRVMuRW1haWxTZXJ2aWNlSW50ZXJmYWNlKS50byhFbWFpbFNlcnZpY2UpLmluU2luZ2xldG9uU2NvcGUoKTsgIFxyXG4gICAgaW9jQ29udGFpbmVyLmJpbmQ8VG9rZW5HZW5lcmF0b3JJbnRlcmZhY2U+KFRZUEVTLlRva2VuR2VuZXJhdG9ySW50ZXJmYWNlKS50byhUb2tlbkdlbmVyYXRvclNlcnZpY2UpLmluU2luZ2xldG9uU2NvcGUoKTtcclxuICAgIGlvY0NvbnRhaW5lci5iaW5kPFRva2VuVmFsaWRhdG9ySW50ZXJmYWNlPihUWVBFUy5Ub2tlblZhbGlkYXRvckludGVyZmFjZSkudG8oVG9rZW5WYWxpZGF0b3JTZXJ2aWNlKS5pblNpbmdsZXRvblNjb3BlKCk7XHJcbiAgICBpb2NDb250YWluZXIuYmluZDxDb29raWVTdG9yYWdlSW50ZXJmYWNlPihUWVBFUy5Db29raWVTdG9yYWdlSW50ZXJmYWNlKS50byhDb29raWVTdG9yYWdlU2VydmljZSkuaW5TaW5nbGV0b25TY29wZSgpO1xyXG4gICAgaW9jQ29udGFpbmVyLmJpbmQ8QWNjZXNzQ29udHJvbEludGVyZmFjZT4oVFlQRVMuQWNjZXNzQ29udHJvbEludGVyZmFjZSkudG8oQWNjZXNzQ29udHJvbFNlcnZpY2UpLmluU2luZ2xldG9uU2NvcGUoKTtcclxuXHJcblxyXG4vLyAzLiBIZWxwZXIgdG8gYmluZCB0aGUgbGl2ZSBEYXRhU291cmNlIGFmdGVyIGNvbm5lY3Rpb25cclxuLyoqXHJcbiAqIEJpbmRzIGEgZ2l2ZW4gRGF0YVNvdXJjZSBpbnN0YW5jZSB0byB0aGUgSW9DIGNvbnRhaW5lciBhcyBhIGNvbnN0YW50IHZhbHVlLlxyXG4gKiBUaGlzIGFsbG93cyBmb3IgZGVwZW5kZW5jeSBpbmplY3Rpb24gb2YgdGhlIERhdGFTb3VyY2UgdGhyb3VnaG91dCB0aGUgYXBwbGljYXRpb24uXHJcbiAqIFxyXG4gKiBAcGFyYW0ge0RhdGFTb3VyY2V9IGRhdGFTb3VyY2UgLSBUaGUgRGF0YVNvdXJjZSBpbnN0YW5jZSB0byBiZSBib3VuZC5cclxuICogQHJldHVybnMge3ZvaWR9XHJcbiAqIEB0aHJvd3Mge0Vycm9yfSBUaHJvd3MgYW4gZXJyb3IgaWYgdGhlIGJpbmRpbmcgZmFpbHMuXHJcbiAqL1xyXG5leHBvcnQgY29uc3QgYmluZERhdGFTb3VyY2UgPSAoZGF0YVNvdXJjZTogRGF0YVNvdXJjZSkgPT4ge1xyXG4gIGlvY0NvbnRhaW5lci5iaW5kPERhdGFTb3VyY2U+KFRZUEVTLkRhdGFTb3VyY2UpLnRvQ29uc3RhbnRWYWx1ZShkYXRhU291cmNlKTtcclxufTtcclxuXHJcbmV4cG9ydCB7IGlvY0NvbnRhaW5lciB9O1xyXG5cclxuXHJcblxyXG5cclxuXHJcbiJdLCJ2ZXJzaW9uIjozfQ==