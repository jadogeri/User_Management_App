{"file":"C:\\Users\\Joseph\\Desktop\\Source\\User_Management_App\\app\\server\\src\\services\\cookie-storage.service.ts","mappings":";;;;;;;;AACA,8CAAwC;AAIxC,IAAM,oBAAoB,GAA1B,MAAM,oBAAoB;IAEtB,OAAO,CAAC,GAAY,EAAE,UAAkB,EAAE,YAAoB;QAC1D,MAAM,GAAG,GAAG,GAAG,CAAC,GAAG,CAAC;QACpB,OAAO,CAAC,GAAG,CAAC,cAAc,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC;QACvC,IAAI,GAAG,EAAE,CAAC;YACN,OAAO,GAAG,CAAC,MAAM,CAAC,UAAU,EAAE,YAAY,EAAE;gBACxC,QAAQ,EAAE,IAAI;gBACd,MAAM,EAAE,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY;gBAC7C,QAAQ,EAAE,KAAK,EAAE,kBAAkB;gBACnC,MAAM,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,SAAS;aAC5C,CAAC,CAAC;QACP,CAAC;QACD,OAAO,SAAgB,CAAC;IAC5B,CAAC;IACD,SAAS,CAAC,GAAY,EAAE,UAAkB;QACtC,MAAM,GAAG,GAAG,GAAG,CAAC,GAAG,CAAC;QACpB,OAAO,CAAC,GAAG,CAAC,cAAc,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC;QACvC,IAAI,GAAG,EAAE,CAAC;YACN,OAAO,GAAG,CAAC,WAAW,CAAC,UAAU,EAAE;gBAC/B,IAAI,EAAE,GAAG,CAAC,IAAI,EAAE,6DAA6D;gBAC7E,QAAQ,EAAE,IAAI;gBACd,MAAM,EAAE,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY;gBAC7C,QAAQ,EAAE,QAAQ;gBAClB,mCAAmC;aACtC,CAAC,CAAA;QACN,CAAC;QACD,OAAO,SAAgB,CAAC;IAC5B,CAAC;CAEJ,CAAA;AA9BK,oBAAoB;IADzB,IAAA,oBAAO,GAAE;GACJ,oBAAoB,CA8BzB;AAED,kBAAe,oBAAoB,CAAC","names":[],"sources":["C:\\Users\\Joseph\\Desktop\\Source\\User_Management_App\\app\\server\\src\\services\\cookie-storage.service.ts"],"sourcesContent":["import { Request, Response } from \"express\";\r\nimport { Service } from \"../decorators\";\r\nimport { CookieStorageInterface } from \"../interfaces/cookie-storage.interface\";\r\n\r\n@Service()\r\nclass CookieStorageService implements CookieStorageInterface {\r\n\r\n    setItem(req: Request, cookieName: string, refreshToken: string): Response<any> {\r\n        const res = req.res;\r\n        console.log(\"res path is \" + req.path);\r\n        if (res) {\r\n            return res.cookie(cookieName, refreshToken, {\r\n                httpOnly: true,\r\n                secure: process.env.NODE_ENV === 'production',\r\n                sameSite: 'lax', // CSRF protection\r\n                maxAge: 7 * 24 * 60 * 60 * 1000 // 7 Days\r\n            });\r\n        }  \r\n        return undefined as any;\r\n    }\r\n    clearItem(req: Request, cookieName: string): Response<any>{\r\n        const res = req.res;\r\n        console.log(\"res path is \" + req.path);\r\n        if (res) {\r\n            return res.clearCookie(cookieName, {\r\n                path: req.path, // CRITICAL: Must match the path used when the cookie was set\r\n                httpOnly: true,\r\n                secure: process.env.NODE_ENV === 'production',\r\n                sameSite: 'strict',\r\n                // Note: Do not include maxAge here\r\n            })\r\n        }\r\n        return undefined as any;\r\n    }\r\n\r\n}\r\n\r\nexport default CookieStorageService;\r\n\r\n"],"version":3}